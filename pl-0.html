<!DOCTYPE html>
<html lang="">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Sketch of PL-0 programming language</title>
        <link rel="stylesheet" href="/assets/main.css"/>
        <script>
// Help the reader estimate how much time the reading is going to take.
// Show word count and reading time estimation in TOC entry.
//
// TOC = table of contents
//
// Known issue: This janks: this DOM manipulation is done after the page is rendered.
// If we don't want jank, we have to manipulate the HTML source before it reaches the browser.
// We assume that the user doesn't refresh the page while reading.
// The benefit of fixing that jank is not enough for me to justify trying to fix it.
document.addEventListener("DOMContentLoaded", function () {
    function count_word (string) {
        return string.trim().split(/\s+/).length;
    }
    function show_quantity (count, singular) {
        let plural = singular + "s"; // For this script only.
        return count + " " + ((count == 1) ? singular : plural);
    }
    function create_length_indicator (word, minute) {
        let e = document.createElement("div");
        e.className = "toc_entry__length_indicator";
        e.textContent = " (" + show_quantity(word, "word") + " ~ " + show_quantity(minute, "minute") + ")";
        return e;
    }
    // We assume that readers read this many words per minute with 100% comprehension.
    // This assumption may not hold for dense texts such as philosophy and mathematics.
    const wpm_assumption = 200;
    // We assume a certain Jekyll template.
    let page = document.querySelector("main.page-content");
    if (page === null) {
        console.log("toc_generate_estimate: Impossible: CSS selector \"main.page-content\" does not match anything");
        return;
    }
    let page_title = document.querySelector("header.post-header h1.post-title");
    if (page_title === null) {
        console.log("toc_generate_estimate: Impossible: CSS selector \"header.post-header h1.post-title\" does not match anything");
        return;
    }
    let page_word = count_word(page.textContent);
    let page_minute = Math.ceil(page_word / wpm_assumption);
    page_title.insertAdjacentElement("afterend", create_length_indicator(page_word, page_minute));
    // We violate the HTML specification.
    // The page may have several elements with the same ID.
    // We assume that Org HTML Export generates a DIV element with ID "table-of-contents".
    // We assume that Jekyll Markdown-to-HTML generates a UL element with ID "markdown-toc".
    // This only works for Org HTML Export's TOC.
    let toc_entries = document.querySelectorAll("#table-of-contents a, #text-table-of-contents a");
    toc_entries.forEach((toc_entry_a) => {
        let href = toc_entry_a.getAttribute("href"); // We assume that this is a string like "#org0123456".
        if (href.charAt(0) !== '#') {
            console.log("toc_generate_estimate: Impossible: " + href + " does not begin with hash sign");
            return;
        }
        // We can't just document.querySelector(href) because target_id may contain invalid ID characters such as periods.
        let target_id = href.substring(1);
        let id_escaped = target_id.replace("\"", "\\\"");
        let h_elem = document.querySelector("[id=\"" + id_escaped + "\"]"); // We assume that this is the h1/h2/h3 element referred by the TOC entry.
        if (h_elem === null) { // We assume that this is impossible.
            console.log("toc_generate_estimate: Impossible: " + href + " does not refer to anything");
            return;
        }
        let section = h_elem.parentNode;
        let section_word = count_word(section.textContent);
        let section_minute = Math.ceil(section_word / wpm_assumption);
        toc_entry_a.insertAdjacentElement("afterend", create_length_indicator(section_word, section_minute));
    });
});
        </script>

        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12628443-6"></script>
<script>
  window['ga-disable-UA-12628443-6'] = window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1";
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-12628443-6');
</script>
        
        <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            jax: ["input/TeX","input/MathML","input/AsciiMath",
            "output/CommonHTML"
            ],
            extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js", "a11y/accessibility-menu.js"],
            TeX: {
                extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
                , equationNumbers: {
                    autoNumber: "AMS"
                }
            },
            "CommonHTML": {
                scale: 100
            },
            "fast-preview": {
                disabled: true,
            }
        });
        </script>
        <style>
            /*
            PreviewHTML produces small Times New Roman text.
            PreviewHTML scale doesn't work.
            */
            .MathJax_PHTML { font-size: 110%; }
        </style>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js" async defer></script>
    </head>
    <body>
        <header class="site-header" role="banner">
            <div class="wrapper">
                <a class="site-title" rel="author" href="/">Erik Dominikus Research Group</a>
            </div>
        </header>
    <div style="display:none;">\(
    \renewcommand\emptyset{\varnothing}
    \newcommand\abs[1]{\left|#1\right|}
    \newcommand\dom{\textrm{dom}}
    \newcommand\cod{\textrm{cod}}
    \newcommand\Bernoulli{\textrm{Bernoulli}}
    \newcommand\Binomial{\textrm{Binomial}}
    \newcommand\Expect[1]{\mathbb{E}[#1]}
    \newcommand\Nat{\mathbb{N}}
    \newcommand\Integers{\mathbb{Z}}
    \newcommand\Real{\mathbb{R}}
    \newcommand\Rational{\mathbb{Q}}
    \newcommand\Complex{\mathbb{C}}
    \newcommand\Pr{\mathrm{P}}
    \newcommand\Time{\text{Time}}
    \newcommand\DTime{\text{DTime}}
    \newcommand\NTime{\text{NTime}}
    \newcommand\TimeP{\text{P}}
    \newcommand\TimeNP{\text{NP}}
    \newcommand\TimeExp{\text{ExpTime}}
    \newcommand\norm[1]{\left\lVert#1\right\rVert}
    \newcommand\bbA{\mathbb{A}}
    \newcommand\bbC{\mathbb{C}}
    \newcommand\bbD{\mathbb{D}}
    \newcommand\bbE{\mathbb{E}}
    \newcommand\bbN{\mathbb{N}}
    \newcommand\frakI{\mathfrak{I}}
    % deprecated; use TimeExp
    \newcommand\ExpTime{\text{ExpTime}}
    \newcommand\Compute{\text{Compute}}
    \newcommand\Search{\text{Search}}
    % model theory structure
    \newcommand\struc[1]{\mathcal{#1}}
    \newcommand\SetBuilder[2]{\{#1 ~|~ #2\}}
    \newcommand\Set[1]{\{#1\}}
    \newcommand\semantics[1]{\langle #1 \rangle}
    \newcommand\bigsemantics[1]{S\left(#1\right)}
    \)</div>
        <main class="page-content" aria-label="Content">
            <div class="wrapper">
                <article class="post">
                    <header class="post-header">
                        <h1 class="post-title">Sketch of PL-0 programming language</h1>
                    </header>
                </article>
                <div class="post-content">
<div class="local_table_of_contents">
<ul>
<li><span class="section_number">1</span><span class="section_title"><a href="#overview">Overview</a></span><span class="word_count">(290w~2m)</span></li>
<li><span class="section_number">2</span><span class="section_title"><a href="#low-level-run-time-system">Low-level run-time system</a></span><span class="word_count">(179w~1m)</span></li>
<li><span class="section_number">3</span><span class="section_title"><a href="#thought">&lt;2019-11-27&gt; Thought</a></span><span class="word_count">(123w~1m)</span></li>
<li><span class="section_number">4</span><span class="section_title"><a href="#guide-for-embedding-pl-0-in-c-programs">Guide for embedding PL-0 in C++ programs</a></span><span class="word_count">(404w~3m)</span></li>
<li><span class="section_number">5</span><span class="section_title"><a href="#the-problem-is-not-binding-the-problem-is-closures">&lt;2019-11-28&gt; The problem is not binding; the problem is closures</a></span><span class="word_count">(63w~1m)</span></li>
<li><span class="section_number">6</span><span class="section_title"><a href="#syntax-and-parsing">Syntax and parsing</a></span><span class="word_count">(359w~2m)</span></li>
<li><span class="section_number">7</span><span class="section_title"><a href="#bottom-up-design">Bottom-up design?</a></span><span class="word_count">(328w~2m)</span></li>
<li><span class="section_number">8</span><span class="section_title"><a href="#bibliography">Bibliography</a></span><span class="word_count">(45w~1m)</span></li>
</ul>
</div>
<h2 id="overview"><span class="section_number">1</span><span class="section_title">Overview</span></h2>
<div class="local_table_of_contents">
<ul>
<li><span class="section_number">1.1</span><span class="section_title"><a href="#what-we-are-going-to-do-here">What we are going to do here</a></span><span class="word_count">(87w~1m)</span></li>
<li><span class="section_number">1.2</span><span class="section_title"><a href="#the-lazy-implementors-language">The lazy implementor's language</a></span><span class="word_count">(204w~2m)</span></li>
</ul>
</div>
<h3 id="what-we-are-going-to-do-here"><span class="section_number">1.1</span><span class="section_title">What we are going to do here</span></h3>
<p>Here we design a <a href="https://en.wikipedia.org/wiki/Lisp_(programming_language)">Lisp</a> and design its interpreter. (Note that Lisp now<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> means a family of languages, not a particular language.)</p>
<p>We name our language &quot;PL-0&quot; (not to be confused with Wirth's PL/0<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>).</p>
<p>We want a programming language for implementing programming languages.</p>
<p>We choose C++ as the implementation language because we don't know any better. We considered Rust and Go but we could not make up our minds. We refuse C because we want namespaces; we refuse to manually prefix every procedure name.</p>
<h3 id="the-lazy-implementors-language"><span class="section_number">1.2</span><span class="section_title">The lazy implementor's language</span></h3>
<p>PL-0 is a lazy implementor's programming language, where the language designers do not strive to please language users.</p>
<p>The focus is on implementability, not usability.</p>
<p>The implementation tries to be stupid, simple, predictable, understandable, not smart.</p>
<p>Our motto is &quot;we only do what we understand&quot; (read: &quot;we only do easy things&quot;).</p>
<p>Here are examples of our incompetence:</p>
<ul>
<li>We don't implement many modern language features like closures, continuations, proper tail calls, and type checking, because we think they are hard to implement. We have not tried to actually implement them; we are spooked by the mere thought of having to implement them.</li>
<li>Parsing is hard, so we only do lexical analysis. The token list becomes the degenerate concrete syntax tree.</li>
<li>Writing a compiler is hard, so we write an interpreter.</li>
</ul>
<p>We thought of making a stack-based language such as Forth<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a> or PostScript, but we don't know how to implement <em>implicit arguments</em> (optional arguments) in a stack-based language, other than by explicitly passing a possibly empty list, so we choose to make a Lisp instead.</p>
<p>The question of Forth vs Lisp is: How hard do we allow the user to crash without foreign procedures: just an exit due to an unhandled exception (Lisp), or an abort due to a segmentation fault (Forth)?</p>
<h2 id="low-level-run-time-system"><span class="section_number">2</span><span class="section_title">Low-level run-time system</span></h2>
<div class="local_table_of_contents">
<ul>
<li><span class="section_number">2.1</span><span class="section_title"><a href="#memory-management">Memory management</a></span><span class="word_count">(177w~1m)</span></li>
</ul>
</div>
<h3 id="memory-management"><span class="section_number">2.1</span><span class="section_title">Memory management</span></h3>
<p>We use a <em>garbage collector</em> because we believe that that garbage collection greatly simplifies the language semantics. Also, we don't know how to implement a Lisp without garbage collection like <a href="https://github.com/wolfgangj/bone-lisp/">Bone Lisp</a>, Pre-Scheme, Carp, newLISP, Linear Lisp, and ThinLisp.</p>
<p>We use a <em>copying garbage collector</em> because we are convinced by Appel 1987 <span class="citation" data-cites="appel1987garbage">[<a href="#ref-appel1987garbage">1</a>]</span><a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a> that &quot;[naïve copying] garbage collection can be faster than stack allocation&quot;.</p>
<p>The drawbacks of our simple choices are:</p>
<ul>
<li>We have to overprovision physical memory if we want our programs to run at a reasonable speed.</li>
<li>We lose real-time guarantee; the program may pause for an unpredictable duration at inopportune times.</li>
</ul>
<p>We may wish to do these later:</p>
<ul>
<li>Improve the garbage collector to be generational and concurrent. Currently we stop the world while we collect garbage because we don't know how to do it concurrently.</li>
<li>Implement alternative garbage collectors and let the programmer choose.</li>
<li>Write a compiler for, say, PL-1, a language with manual memory management, and probably also static typing, on top of PL-0. Thus the real-time part of the program can be written in PL-1 while seamlessly interoperating with PL-0.</li>
</ul>
<h2 id="thought"><span class="section_number">3</span><span class="section_title">&lt;2019-11-27&gt; Thought</span></h2>
<p>It is easy to process a byte list into a token list.</p>
<p>The question is: How should we interpret that token list? How should we ascribe meaning to that token list? How should we map tokens to values?</p>
<p>The lowest layer is more like a library for manipulating tokens than a language.</p>
<p>A stream of bytes is translated into a stream of tokens. A token is either <em>white</em> or <em>black</em>. A token has <em>location</em>. A token list has <em>location</em>.</p>
<p>I want to use the same name &quot;append&quot; for appending lists and appending strings; I don't want &quot;list-append&quot; and &quot;string-append&quot;. We can implement this with types or namespaces. I'm fine with explicitly-prefixed namespaces like this:</p>
<pre class="example"><code>(define (example)
  (import list)
  (import string)
  (list:append &#39;(1) &#39;(2))
  (string:append &quot;a&quot; &quot;b&quot;))
</code></pre>
<p>Peter Van Roy's &quot;Programming Paradigms for Dummies: What Every Programmer Should Know&quot; <a href="https://www.info.ucl.ac.be/~pvr/VanRoyChapter.pdf">https://www.info.ucl.ac.be/~pvr/VanRoyChapter.pdf</a></p>
<h2 id="guide-for-embedding-pl-0-in-c-programs"><span class="section_number">4</span><span class="section_title">Guide for embedding PL-0 in C++ programs</span></h2>
<div class="local_table_of_contents">
<ul>
<li><span class="section_number">4.1</span><span class="section_title"><a href="#pl-0-c-conventions">PL-0 C++ conventions</a></span><span class="word_count">(7w~1m)</span></li>
<li><span class="section_number">4.2</span><span class="section_title"><a href="#creating-a-virtual-machine">Creating a virtual machine</a></span><span class="word_count">(35w~1m)</span></li>
<li><span class="section_number">4.3</span><span class="section_title"><a href="#executing-programs">Executing programs</a></span><span class="word_count">(161w~1m)</span></li>
<li><span class="section_number">4.4</span><span class="section_title"><a href="#creating-primitives">Creating primitives</a></span><span class="word_count">(20w~1m)</span></li>
<li><span class="section_number">4.5</span><span class="section_title"><a href="#quoting">Quoting</a></span><span class="word_count">(20w~1m)</span></li>
<li><span class="section_number">4.6</span><span class="section_title"><a href="#macros">Macros</a></span><span class="word_count">(29w~1m)</span></li>
<li><span class="section_number">4.7</span><span class="section_title"><a href="#what">What?</a></span><span class="word_count">(132w~1m)</span></li>
</ul>
</div>
<h3 id="pl-0-c-conventions"><span class="section_number">4.1</span><span class="section_title">PL-0 C++ conventions</span></h3>
<p>The C++ namespace is <code>stc_pl_0</code>.</p>
<h3 id="creating-a-virtual-machine"><span class="section_number">4.2</span><span class="section_title">Creating a virtual machine</span></h3>
<p>Each instance of the <code>Machine</code> class is a virtual machine with operand stack, dictionary stack, return stack, and heap. The size of each memory area is fixed when the <code>Machine</code> is instantiated.</p>
<pre class="example"><code>Machine machine;
</code></pre>
<h3 id="executing-programs"><span class="section_number">4.3</span><span class="section_title">Executing programs</span></h3>
<p>A <em>program</em> is a sequence of tokens. For example, &quot;1&quot; is a program that pushes the word 1 to the stack. The following is a program that consists of <em>six</em> tokens (1, space, 2, space, add, newline):</p>
<pre class="example"><code>1 2 add
</code></pre>
<pre class="example"><code>void            Machine::push_source (Token_Iterator&amp;)
Token_Iterator&amp; Machine::pop_source ()
</code></pre>
<p>A <em>token iterator</em> can be created from an in-memory token list or an in-disk source file. A file-based token-iterator maintains a location (path, line, column, byte offset).</p>
<p>A <em>token</em> is a byte string with location information (to keep track of its provenance).</p>
<p>Typically, <code>Machine::step</code> is called in a loop. An iteration in the execution loop goes like this, if we ignore errors:</p>
<ul>
<li>read token</li>
<li>determine the executable of that token</li>
<li>execute that executable (a primitive, a value, a token, or a token list)</li>
</ul>
<p><em>The <code>step</code> method executes at most one token.</em> If the meaning of the token is a token list, then <code>step</code> creates a call frame and arranges the next <code>step</code> call to execute the first token of the subroutine.</p>
<p>The machine reads the current program from a token iterator.</p>
<h3 id="creating-primitives"><span class="section_number">4.4</span><span class="section_title">Creating primitives</span></h3>
<p>A <em>primitive</em> is a foreign procedure that may mutate the machine state.</p>
<pre class="example"><code>using Prim = void (Machine&amp;);
</code></pre>
<p>A primitive must not throw any C++ exceptions.</p>
<h3 id="quoting"><span class="section_number">4.5</span><span class="section_title">Quoting</span></h3>
<p>The program <code>quote W B</code> pushes <code>B</code> to the operand stack where <code>W</code> is expected to be a white token.</p>
<h3 id="macros"><span class="section_number">4.6</span><span class="section_title">Macros</span></h3>
<p>A macro is a procedure that transforms a prefix of the remaining program token stream.</p>
<p>A macro transforms a concrete syntax tree.</p>
<p>Important: Whitespaces are tokens too.</p>
<p>Macro : Cst -&gt; Cst</p>
<h3 id="what"><span class="section_number">4.7</span><span class="section_title">What?</span></h3>
<pre class="example"><code>% A B C muladd -&gt; A*B+C

quote muladd { mul add } def

define (muladd x y z)
  x y mul z add
end
</code></pre>
<p>Curly braces delimit a token list?</p>
<p>Macros are ordinary functions.</p>
<p><code>quote</code> reads the token right after the token currently being interpreted but does not execute it.</p>
<pre class="example"><code>1 2 quote add -&gt; 1 2 add
1 2 add -&gt; 3
</code></pre>
<p>Type information can be attached to value (Scheme), variable (C++), or function (Assembly). If we want function polymorphism (Scheme display), then we must choose to attach type information at either value or variable.</p>
<p>Why choose? Why not attach type information everywhere (to values, variables, and functions)?</p>
<p>If we want <code>read</code> to produce a value (not a type-value pair), then values must carry type information.</p>
<p>In mathematics, it is natural to overload functions (such as +). Otherwise we would have +N, +Q, +R, etc. which is ugly. Do we care about what something is, or about what can we do with it?</p>
<p>PostScript enables the programmer to choose between early binding and late binding.</p>
<h2 id="the-problem-is-not-binding-the-problem-is-closures"><span class="section_number">5</span><span class="section_title">&lt;2019-11-28&gt; The problem is not binding; the problem is closures</span></h2>
<p>If we don't have closures, then it does not matter whether we use static (lexical) or dynamic binding; the result will be the same.</p>
<p>The problem is not static vs dynamic binding. The problem is: Should we have closures or not?</p>
<p>Why do we bother having closures if programmers can do explicit closure conversion? For example:</p>
<pre class="example"><code>f x = \ y -&gt; x + y
-- gets closure-converted to
f x = (\ x y -&gt; x + y) x
</code></pre>
<h2 id="syntax-and-parsing"><span class="section_number">6</span><span class="section_title">Syntax and parsing</span></h2>
<div class="local_table_of_contents">
<ul>
<li><span class="section_number">6.1</span><span class="section_title"><a href="#reversibility-information-preservation">Reversibility, information-preservation</a></span><span class="word_count">(151w~1m)</span></li>
<li><span class="section_number">6.2</span><span class="section_title"><a href="#locations">Locations</a></span><span class="word_count">(24w~1m)</span></li>
<li><span class="section_number">6.3</span><span class="section_title"><a href="#macro-reflection-reification-quoting">Macro, reflection, reification, quoting</a></span><span class="word_count">(22w~1m)</span></li>
<li><span class="section_number">6.4</span><span class="section_title"><a href="#annotations-user-defined-metadata-attached-to-concrete-syntax-tree-nodes">Annotations: user-defined metadata attached to concrete syntax tree nodes</a></span><span class="word_count">(163w~1m)</span></li>
</ul>
</div>
<h3 id="reversibility-information-preservation"><span class="section_number">6.1</span><span class="section_title">Reversibility, information-preservation</span></h3>
<p>I insist that the parser be reversible, because I want traceability and debuggability.</p>
<p>Each stage must be reversible: it must either be a bijection or preserve enough information from the previous stage.</p>
<p>The first stage is character + location (defined later).</p>
<p>The next stage is tokenization.</p>
<p>A token has type and a list of characters.</p>
<p>The next stage is concrete syntax tree (CST).</p>
<p>The concrete syntax tree is required for formatting and refactoring, because those activities should preserve comments.</p>
<p>In Lisp syntax, a token coincides with an AST node.</p>
<p>The next stage is abstract syntax tree.</p>
<p>An AST node has a &quot;main&quot; CST node.</p>
<p>An AST node has a &quot;preceding-whites&quot; (a list of whitespace CST nodes that precede that AST node) so that the AST node can be turned back into CST node (and so on until we reach the original substring that constitutes the CST node).</p>
<p>The parser is a recursive descent parser because I don't know how to parse.</p>
<h3 id="locations"><span class="section_number">6.2</span><span class="section_title">Locations</span></h3>
<p>A <em>location</em> is a tuple of path, line (0-based), column (0-based), byte-offset. This is like Racket srcloc.</p>
<p><code>current-location</code> parameter</p>
<p><code>read</code> from current location</p>
<p><code>raise-parse-error</code> at current location</p>
<h3 id="macro-reflection-reification-quoting"><span class="section_number">6.3</span><span class="section_title">Macro, reflection, reification, quoting</span></h3>
<p>The language should be a model of itself.</p>
<p>The language should be able to describe itself.</p>
<p>Does that cause a paradox?</p>
<h3 id="annotations-user-defined-metadata-attached-to-concrete-syntax-tree-nodes"><span class="section_number">6.4</span><span class="section_title">Annotations: user-defined metadata attached to concrete syntax tree nodes</span></h3>
<p>(Is this a good idea?)</p>
<p>We add these expression syntax rules:</p>
<ul>
<li>If M is an expression and E is an expression, then <code>E : M</code> (read: data E annotated with metadata M) is an <em>annotated expression</em>.
<ul>
<li>Alternative syntax: <code>E : M</code> can also be written <code>meta M E</code>.</li>
</ul></li>
</ul>
<p>This generalizes type systems. With type systems, you annotate an expression with a type expression. With general annotations, you annotate an expression with another expression (some of which are type expressions).</p>
<p>We assume that the outermost metadata update wins:</p>
<ul>
<li>meta M (meta N E) = meta M E</li>
</ul>
<p>We add metadata extraction function symbol <code>meta-of</code>.</p>
<p>We add these beta-reduction rules:</p>
<ul>
<li>reduce (meta M E) = reduce E</li>
<li>reduce (meta-of (meta M E)) = reduce M</li>
<li>reduce (meta-of E) = #&lt;empty-record&gt; (for expressions without metadata)</li>
</ul>
<p>This is like Java/C# annotation but more principled?</p>
<p>Annotations are not types.</p>
<p>This is an example of type annotation that our annotation above can't handle: <code>\ (x : T) -&gt; y</code>, because <code>x</code> is not an expression.</p>
<h2 id="bottom-up-design"><span class="section_number">7</span><span class="section_title">Bottom-up design?</span></h2>
<div class="local_table_of_contents">
<ul>
<li><span class="section_number">7.1</span><span class="section_title"><a href="#example">Example</a></span><span class="word_count">(85w~1m)</span></li>
<li><span class="section_number">7.2</span><span class="section_title"><a href="#starting-with-assembly">Starting with assembly</a></span><span class="word_count">(243w~2m)</span></li>
</ul>
</div>
<h3 id="example"><span class="section_number">7.1</span><span class="section_title">Example</span></h3>
<ul>
<li>Example of bottom-up language design and how each level reduces cognitive load:
<ul>
<li>Begin with machine code.</li>
<li>Provide mnemonics for instructions.</li>
<li>Provide the illusion of infinite custom-named registers and orthogonal operands.</li>
<li>Provide macros subroutines as extensible instructions.</li>
<li>Provide the illusion of infinite custom-named registers and orthogonal operands.</li>
<li>Provide macros and subroutines as extensible instructions.</li>
<li>Provide named locations.</li>
<li>Provide the illusion of infinite memory.</li>
<li>Abstract away processor registers.</li>
<li>Abstract away pointers.</li>
<li>Expression.</li>
<li>Infix expression syntax.</li>
<li>First-class functions.</li>
<li>The program itself is a procedural program that tells the interpreter what code to generate.</li>
<li>End up with something like Randall Hyde's High Level Assembly?</li>
</ul></li>
</ul>
<h3 id="starting-with-assembly"><span class="section_number">7.2</span><span class="section_title">Starting with assembly</span></h3>
<p>PL-0 is slightly more abstract than typed assembly languages (TALs).</p>
<p>We may begin from x86 assembly.</p>
<p>First we abstract away locations, registers, memory, so that we can write something like this:</p>
<pre class="example"><code>mov dword ptr [var_1], [var_2]
</code></pre>
<p>Macro Assembler (MASM)? TASM, NASM, what?</p>
<p>There does not exist a computer with infinite memory. Why do we pretend, with garbage collection, that the computer had infinite memory? Because it simplifies most problems?</p>
<p>What is the problem with these: High-Level Assembly, typed assembly languages such as TALx86 <span class="citation" data-cites="crary1999talx86">[<a href="#ref-crary1999talx86">2</a>]</span><a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>, LLVM IR, MSIL, JVM bytecodes?</p>
<p>We can add a type system to assembly language to enforce constraints like these:</p>
<ul>
<li>&quot;Add-integer&quot; takes two integers.</li>
<li>&quot;Add-pointer&quot; takes a pointer of alignment N and an integer that is an integral multiple of N.</li>
<li>It is illegal to add two pointers.</li>
</ul>
<p>For example, a type may be:</p>
<ul>
<li><code>Integer N</code> where N is 1, 2, 4, or 8</li>
<li><code>Pointer A</code> where A is the alignment (1, 2, 4, or 8)</li>
</ul>
<p>One difficulty is that the same register may sometimes contain an integer and sometimes contain a pointer.</p>
<p>We can &quot;solve&quot; that with Static Single Assignment (SSA) Form and automatic register allocation.</p>
<p>But perhaps the bigger issue is to abstract away the difference between processors; why should we care if it is an Intel processor, a Motorola processor, a Symbolics Lisp machine, or something else?</p>
<p>Even though the machine does not know about subroutines, we organize our programs into subroutines; we find it more convenient to work with subroutines than to work with instructions. We feel that the instructions are too finely-grained, unnecessarily detailed.</p>
<h2 id="bibliography" class="unnumbered"><span class="section_number">8</span><span class="section_title">Bibliography</span></h2>
<div id="refs" class="references">
<div id="ref-appel1987garbage">
<p>[1] Appel, A.W. 1987. Garbage collection can be faster than stack allocation. <em>Information Processing Letters</em>. 25, 4 (1987), 275–279.</p>
</div>
<div id="ref-crary1999talx86">
<p>[2] Crary, K. et al. 1999. TALx86: A realistic typed assembly language. <em>1999 acm sigplan workshop on compiler support for system software atlanta, ga, usa</em> (1999), 25–35.</p>
</div>
</div>
<section class="footnotes">
<hr />
<ol>
<li id="fn1"><p>&lt;2019-12-10&gt;<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>&lt;2019-11-18&gt; <a href="https://en.wikipedia.org/wiki/PL/0">https://en.wikipedia.org/wiki/PL/0</a><a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>&lt;2019-11-18&gt; <a href="https://en.wikipedia.org/wiki/Forth_(programming_language)">https://en.wikipedia.org/wiki/Forth_(programming_language)</a><a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p>via <a href="https://softwareengineering.stackexchange.com/questions/364371/type-based-memory-safety-without-manual-memory-manage-or-runtime-garbage-collect">Basile Starynkevitch</a><a href="#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p>&lt;2019-11-04&gt; <a href="https://www.cis.upenn.edu/~stevez/papers/MCGG99.pdf">https://www.cis.upenn.edu/~stevez/papers/MCGG99.pdf</a><a href="#fnref5" class="footnote-back">↩</a></p></li>
</ol>
</section>
                </div>
            </div>
        </main>
        <footer class="site-footer h-card">
            <data class="u-url" href="/"></data>
            <div class="wrapper">
                <p>This page was created on 2019-02-07 00:00:00 +0700.</p>
                <p class="rss-subscribe">The
                    <a href="/feed.xml">RSS feed</a> of this website has not been implemented.</p>
                <p>
                    I used Disqus, but I removed it because it hijacks my links and redirects them to third-party ad networks.
                    On 2019-05-27, a friend of mine reported that links on my website were broken,
                    and I caught Disqus red-handed redirecting my links to pwieu.com.
                </p>
            </div>
        </footer>
    </body>
</html>
